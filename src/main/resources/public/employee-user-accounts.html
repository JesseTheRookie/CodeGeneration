<!DOCTYPE html>
<html>

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous" />

    <!--Nieuwe stylesheets-->
    <link rel="stylesheet" type="text/css" media="screen" href="css/generic.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="css/reset.css" />

    <title>Hello, world!</title>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <!-- THIS IS THE RIGHT JQUERY-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>
    <script src="/js/findGetParameter.js" type='text/javascript'></script>


        <script type="text/javascript">
    
            function showAccount(accounts) {
                console.time('showAccounts')
                showCurrentAccount(accounts);
                showSavingsAccount(accounts);
                console.timeEnd('showAccounts')
            }
    
            function showCurrentAccount(account) {
    
                currentAccountCount = 0;
                for (let index = 0; index < account.length; index++) {
                    const element = account[index];
    
                    if (element.Accounttype == "current") {
                        $("#currents").append('<a href="/get-transactions?iban=' + element.Iban + '"><li class=""><p>IBAN: ' + element.Iban + ', Balance: €' + element.Balance + '</p></li></a><input type="submit" class="btn btn-secondary" value="Freeze">');
                        currentAccountCount++;
                    }
                }
    
                if (currentAccountCount > 0) {
                    $("#currentTitle").css("display", "block");
                }
            }
    
            function showSavingsAccount(account) {
    
                savingsAccountCount = 0;
                //savingStringBuilder = "";
                for (let index = 0; index < account.length; index++) {
                    const element = account[index];
                    console.log(element);
    
                    if (element.Accounttype == "savings") {
                        $("#savings").append('<a href="/get-transactions?iban=' + element.Iban + '"><li class=""><p>IBAN: ' + element.Iban + ', Balance: €' + element.Balance + '</p></li></a><input type="submit" class="btn btn-secondary " value="Freeze">');
                        savingsAccountCount++;
                    }
                }
    
                if (savingsAccountCount > 0) {
                    $("#savingsTitle").css("display", "block");
                }
            }
    
            $(document).ready(function () {
                var userInfo;
                var userAccounts;
                var userId;

                if (findGetParameter("user-id")) {
                var userId = findGetParameter("user-id");
                }
    
                $.ajax({
                    async: false,
                    type: "GET",
                    url: "/userinfo",
                    data: "",
                    contentType: "application/json",
                    success: function (data) {
                        userInfo = data;
                    }
                });
    
                $.ajax({
                    async: false,
                    type: "GET",
                    url: "/users/" + userId + "/accounts",
                    data: "",
                    contentType: "application/json",
                    success: function (data) {
                        userAccounts = data;
                        console.log(data);
                        showAccount(data);
                        $("#user").text(data[0].Name);

                    }
                });
                
                
            });
        </script>
</head>

<body>
    <header id="header">
        <h1>Employee dashboard</h1>
    </header>
    <a type="button" class="btn btn-primary" href="/logout">Logout</a>
    <a type="button" class="btn btn-primary" href="/withdrawals">withdrawals</a>
    <a type="button" class="btn btn-primary" href="/deposits">Deposits</a>
    <a type="button" class="btn btn-primary" href="/transactions">Transactions</a>
    <a type="button" class="btn btn-primary" href="/get-users">Users</a>
    <a type="button" class="btn btn-primary" href="/get-accounts">Accounts</a>
    <nav id="sideMenu">
        <h1>Employee tools</h1>
        <ul>
            <li class="active">Manage users</li>
            <li>Transactions</li>
            <br>
            <a type="button" class="btn btn-primary" href="/employee-user-new-deposit.html">Create Deposit</a>
            <a type="button" class="btn btn-primary" href="/employee-user-new-withdrawal.html">Create Withdrawal</a>
            <br>
            <a type="button" class="btn btn-primary" href="/create-transaction">Make Transaction</a>
            <br>
            <a type="button" class="btn btn-primary" href="/create-users">Create users</a>
            <a type="button" class="btn btn-primary" href="/create-accounts">Create accounts</a>
        </ul>
    </nav>
    
    <section class="rightSection">
        <h1 id="user"></h1>

        <h1 id="currentTitle" style="display: none;">Current accounts</h1>
        <ul id="currents" class="list">

        </ul>

        <h1 id="savingsTitle" style="display: none;">Savings accounts</h1>
        <ul id="savings" class="list">

        </ul>
<!-- 
        <ul id="currents" class="list">
            <h1>current accounts</h1>
            <a href="#">
                <li>
                    <p>iban</p>
                    <p>amount</p>
                    <input type="submit" value="Freeze">
                </li>
            </a><br>
            <a href="#">
                <li>
                    <p>iban</p>
                    <p>amount</p>
                    <input type="submit" value="Freeze">
                </li>
            </a><br>

        </ul>
        <ul id="savings" class="list">
            <h1>savings accounts</h1>
            <a href="#">
                <li>
                    <p>iban</p>
                    <p>amount</p>
                    <input type="submit" value="Freeze">
                </li>
            </a><br>
            <a href="#">
                <li>
                    <p>iban</p>
                    <p>amount</p>
                    <input type="submit" value="Freeze">
                </li>
            </a><br>

        </ul> -->
    </section>
</body>

</html>